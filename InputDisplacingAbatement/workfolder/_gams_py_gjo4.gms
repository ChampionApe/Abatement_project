$ONEOLCOM
$EOLCOM #


# Root File for model
OPTION SYSOUT=OFF, SOLPRINT=OFF, LIMROW=0, LIMCOL=0, DECIMALS=6;
;

# ----------------------------------------------------------------------------------------------------
#  Import file: C:\Users\sxj477\Documents\GitHub\Abatement_project\InputDisplacingAbatement\workfolder\FG_CollectFile.gms
# ----------------------------------------------------------------------------------------------------


# ----------------------------------------------------------------------------------------------------
#  Import file: C:\Users\sxj477\Documents\GitHub\Abatement_project\InputDisplacingAbatement\workfolder\FG_functions.gms
# ----------------------------------------------------------------------------------------------------


# ----------------------------------------------------------------------------------------------------
#  Define function: load_level
# ----------------------------------------------------------------------------------------------------



# ----------------------------------------------------------------------------------------------------
#  Define function: load_fixed
# ----------------------------------------------------------------------------------------------------


;

# ----------------------------------------------------------------------------------------------------
#  Import file: C:\Users\sxj477\Documents\GitHub\Abatement_project\InputDisplacingAbatement\workfolder\FG_sets.gms
# ----------------------------------------------------------------------------------------------------

sets
	alias_map2
	alias_set
	n
;

alias(n,nn,nnn);

sets
	sec_FG[n]
	agg_FG[n]
	alias_[alias_set,alias_map2]
	in_FG2agg_FG[n,nn]
	in_FG[n]
	out_FG[n]
;
$GDXIN %FG%
$onMulti
$load alias_map2
$load alias_set
$load n
$load sec_FG
$load agg_FG
$load out_FG
$load in_FG
$load alias_
$load in_FG2agg_FG
$GDXIN
$offMulti
;

# ----------------------------------------------------------------------------------------------------
#  Import file: C:\Users\sxj477\Documents\GitHub\Abatement_project\InputDisplacingAbatement\workfolder\FG_parameters.gms
# ----------------------------------------------------------------------------------------------------

;

# ----------------------------------------------------------------------------------------------------
#  Import file: C:\Users\sxj477\Documents\GitHub\Abatement_project\InputDisplacingAbatement\workfolder\FG_groups.gms
# ----------------------------------------------------------------------------------------------------


# -----------------------------------------------FG_tech----------------------------------------------
#  Initialize FG_tech group
# ----------------------------------------------------------------------------------------------------
$offlisting
VARIABLE sigma[n] "";
sigma.L[n]$((agg_FG[n])) = 0;
VARIABLE mu[n,nn] "";
mu.L[n,nn]$((in_FG2agg_FG[n,nn])) = 0;
$onlisting


# -----------------------------------------------FG_exo-----------------------------------------------
#  Initialize FG_exo group
# ----------------------------------------------------------------------------------------------------
$offlisting
VARIABLE p[n] "";
p.L[n]$((in_FG[n])) = 0;
VARIABLE q[n] "";
q.L[n]$((out_FG[n])) = 0;
$onlisting


# -----------------------------------------------FG_endo----------------------------------------------
#  Initialize FG_endo group
# ----------------------------------------------------------------------------------------------------
$offlisting
$onlisting
$offlisting
  
# --------------------------------------------__load_group--------------------------------------------
#  Initialize __load_group group
# ----------------------------------------------------------------------------------------------------
$offlisting
$onlisting
  
# ----------------------------------------------------------------------------------------------------
#  Loop over __load_group
# ----------------------------------------------------------------------------------------------------

    parameter load_p[n] "";
    load_p[n]$(((agg_FG[n]))) = 0;
  
    parameter load_q[n] "";
    load_q[n]$(((sec_FG[n] and not out_FG[n]))) = 0;
  
  execute_load "%FG%" 
# ----------------------------------------------------------------------------------------------------
#  Loop over __load_group
# ----------------------------------------------------------------------------------------------------
 load_p=p.l  load_q=q.l ;
  
# ----------------------------------------------------------------------------------------------------
#  Loop over __load_group
# ----------------------------------------------------------------------------------------------------

    p.l[n]$(((agg_FG[n]))) = load_p[n];
  
    q.l[n]$(((sec_FG[n] and not out_FG[n]))) = load_q[n];
$onlisting
;
$offlisting
  
# --------------------------------------------__load_group--------------------------------------------
#  Initialize __load_group group
# ----------------------------------------------------------------------------------------------------
$offlisting
$onlisting
  
# ----------------------------------------------------------------------------------------------------
#  Loop over __load_group
# ----------------------------------------------------------------------------------------------------

    parameter load_sigma[n] "";
    load_sigma[n]$(((agg_FG[n]))) = 0;
  
    parameter load_mu[n,nn] "";
    load_mu[n,nn]$(((in_FG2agg_FG[n,nn]))) = 0;
  
  execute_load "%FG%" 
# ----------------------------------------------------------------------------------------------------
#  Loop over __load_group
# ----------------------------------------------------------------------------------------------------
 load_sigma=sigma.l  load_mu=mu.l ;
  
# ----------------------------------------------------------------------------------------------------
#  Loop over __load_group
# ----------------------------------------------------------------------------------------------------

    sigma.fx[n]$(((agg_FG[n]))) = load_sigma[n];
  
    mu.fx[n,nn]$(((in_FG2agg_FG[n,nn]))) = load_mu[n,nn];
$onlisting
;
$offlisting
  
# --------------------------------------------__load_group--------------------------------------------
#  Initialize __load_group group
# ----------------------------------------------------------------------------------------------------
$offlisting
$onlisting
  
# ----------------------------------------------------------------------------------------------------
#  Loop over __load_group
# ----------------------------------------------------------------------------------------------------

    parameter load_p[n] "";
    load_p[n]$(((in_FG[n]))) = 0;
  
    parameter load_q[n] "";
    load_q[n]$(((out_FG[n]))) = 0;
  
  execute_load "%FG%" 
# ----------------------------------------------------------------------------------------------------
#  Loop over __load_group
# ----------------------------------------------------------------------------------------------------
 load_p=p.l  load_q=q.l ;
  
# ----------------------------------------------------------------------------------------------------
#  Loop over __load_group
# ----------------------------------------------------------------------------------------------------

    p.fx[n]$(((in_FG[n]))) = load_p[n];
  
    q.fx[n]$(((out_FG[n]))) = load_q[n];
$onlisting
;
;

# ----------------------------------------------------------------------------------------------------
#  Import file: C:\Users\sxj477\Documents\GitHub\Abatement_project\InputDisplacingAbatement\workfolder\FG_blocks.gms
# ----------------------------------------------------------------------------------------------------



# ------------------------------------------------M_FG------------------------------------------------
#  Initialize M_FG equation block
# ----------------------------------------------------------------------------------------------------
EQUATION E_FG_q[n];
E_FG_q[n]$((sec_fg[n] and not out_fg[n])).. 	q[n]  =E=  sum(nn$(in_FG2agg_FG[n,nn]), mu[n,nn]*(p[n]/p[nn])**(-sigma[nn])*q[nn]);
EQUATION E_FG_p[n];
E_FG_p[n]$((agg_fg[n])).. 	p[n]  =E=  sum(nn$(in_FG2agg_FG[nn,n]), mu[nn,n] * p[nn]**(1-sigma[n]))**(1/(1-sigma[n]));

# ----------------------------------------------------------------------------------------------------
#  Define M_FG model
# ----------------------------------------------------------------------------------------------------
Model M_FG /
E_FG_q, E_FG_p
/;


;
;

# ----------------------------------------------------------------------------------------------------
#  Import file: C:\Users\sxj477\Documents\GitHub\Abatement_project\InputDisplacingAbatement\workfolder\RunFile.gms
# ----------------------------------------------------------------------------------------------------


# ----------------------------------------------------------------------------------------------------$FIX FG_tech, FG_exo;
# ----------------------------------------------------------------------------------------------------
$offlisting
sigma.FX[n]$((agg_FG[n])) = sigma.L[n];
mu.FX[n,nn]$((in_FG2agg_FG[n,nn])) = mu.L[n,nn];
p.FX[n]$((in_FG[n])) = p.L[n];
q.FX[n]$((out_FG[n])) = q.L[n];
$onlisting


# ----------------------------------------------------------------------------------------------------$UNFIX FG_endo;
# ----------------------------------------------------------------------------------------------------
$offlisting
p.lo[n]$((agg_FG[n])) = -inf;
p.up[n]$((agg_FG[n])) = inf;
q.lo[n]$((sec_FG[n] and not out_FG[n])) = -inf;
q.up[n]$((sec_FG[n] and not out_FG[n])) = inf;
$onlisting


# ----------------------------------------------------------------------------------------------------
#  Define FG model
# ----------------------------------------------------------------------------------------------------
Model FG /
E_FG_q, E_FG_p
/;


solve FG using CNS;
;
